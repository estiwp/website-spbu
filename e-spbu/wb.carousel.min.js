/*
 * jQuery Carousel Plugin for WYSIWYG Web Builder 9
 * Copyright Pablo Software solutions 2013
 * http://www.wysiwygwebbuilder.com/
 */
(function(q){q.fn.carousel=function(g){var d={delay:3E3,duration:500,easing:"linear",fullwidth:!1,mode:"forward",pagination:!0,pagination_img_default:"",pagination_img_active:"",start:0},n;n=g&&"string"==typeof g?g:q.extend(d,g);return this.each(function(){q.carousel(this,n)})};q.carousel=function(g,d){function n(b,c){var a=b.data("carousel");if("forward-backward"==a.mode)0==a.currentFrame&&(c=0),a.currentFrame==a.count-1&&(c=1),a.direction=c;else if("forward-circular"==a.mode||"backward-circular"==
a.mode){if(0==a.currentFrame&&1==c){var d=a.currentFrame;a.currentFrame=a.count-1;a.pagination&&m(b,d,a.currentFrame);b.find(".frame:last").css({marginLeft:-1*a.width*(a.currentFrame+1)+"px"}).children().css({marginLeft:-1*a.width*(a.currentFrame+1)+"px"});b.stop().animate({left:"+="+a.width},a.duration,a.easing,function(){b.css("left","-"+(a.total_width-a.width)+"px");b.find(".frame:last").css({marginLeft:"0px"}).children().css({marginLeft:"0px"});h(b,a.width*a.currentFrame,0,a.easing)});return!1}if(a.currentFrame==
a.count-1&&0==c){d=a.currentFrame;a.currentFrame=0;a.pagination&&m(b,d,a.currentFrame);b.find(".frame:first").css({position:"relative",left:a.total_width+"px"});b.stop().animate({left:"-="+a.width},a.duration,a.easing,function(){b.css("left","0px");b.find(".frame:first").css("left","0px");h(b,a.width*a.currentFrame,0,a.easing)});return}}0==c?w(b):x(b);"forward-backward"==a.mode&&($("#"+b.attr("id")+"_next").css("display",a.currentFrame==a.count-1?"none":"block"),$("#"+b.attr("id")+"_back").css("display",
0==a.currentFrame?"none":"block"))}function x(b){var c=b.data("carousel"),a=c.currentFrame;c.currentFrame=0==c.currentFrame?c.count-1:Math.max(c.currentFrame-1,0);c.pagination&&m(b,a,c.currentFrame);h(b,c.width*c.currentFrame,c.duration,c.easing)}function w(b){var c=b.data("carousel"),a=c.currentFrame;c.currentFrame=c.currentFrame==c.count-1?0:Math.min(c.currentFrame+1,c.count-1);c.pagination&&m(b,a,c.currentFrame);h(b,c.width*c.currentFrame,c.duration,c.easing)}function y(b,c){r(b);var a=b.data("carousel"),
d=a.currentFrame;a.currentFrame=Math.min(c-1,a.count-1);a.pagination&&m(b,d,a.currentFrame);h(b,a.width*a.currentFrame,a.duration,a.easing);"forward-backward"==a.mode&&($("#"+b.attr("id")+"_next").css("display",a.currentFrame==a.count-1?"none":"block"),$("#"+b.attr("id")+"_back").css("display",0==a.currentFrame?"none":"block"))}function r(b){b=b.data("timerId");clearInterval(b)}function m(b,c,a){var d=b.data("carousel");b.parent().find(".pagination img:eq("+c+")").attr("src",d.pagination_img_default);
b.parent().find(".pagination img:eq("+a+")").attr("src",d.pagination_img_active)}function h(b,c,a,d){b.animate({left:-c},a,d)}function z(b){var c=0;"undefined"!=typeof window.innerWidth?c=window.innerWidth:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?c=document.documentElement.clientWidth:(c=document.getElementsByTagName("body")[0].clientWidth,document.getElementsByTagName("body"));$(b).parent().css("width",
"100%");$(b).parent().css("left","0");var a=$(b).data("carousel");$(b).css("width",a.count*c+"px");a.total_width=a.count*c;a.width=c;$(b).parent().find(".pagination").each(function(a){$(this).css({left:(c-$(this).width())/2+"px"})});$(b).parent().find(".frame").each(function(b){$(this).css({width:c+"px"});var d=(c-a.original_width)/2+(c-a.original_width)*b;$(this).children().each(function(){var a=0,a=$(this).data("left");void 0!=a?a=parseInt(a):(a=parseInt($(this).css("left")),$(this).data("left",
a+"px"));$(this).css("left",a+d+"px")})});$(b).css({left:-a.width*a.currentFrame})}function C(b){s=b.targetTouches[0].pageX;t=b.targetTouches[0].pageY;u=s;v=t;r(e)}function D(b){b.preventDefault();u=b.targetTouches[0].pageX;v=b.targetTouches[0].pageY;var c=u-s,a=v-t;b=Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(a,2)));c=A(c,a);"left"==c?h(e,f.width*f.currentFrame+b,0,""):"right"==c&&h(e,f.width*f.currentFrame-b,0,"")}function E(b){var c=u-s,a=v-t;50<=Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(a,
2)))?(b=A(c,a),"left"==b?w(e):"right"==b&&x(e)):B(b)}function B(b){v=u=t=s=0;h(e,f.width*f.currentFrame,f.duration,f.easing)}function A(b,c){var a=Math.atan2(c,-b),a=Math.round(180*a/Math.PI);0>a&&(a=360-Math.abs(a));return 45>=a&&0<=a||360>=a&&315<=a?"left":135<=a&&225>=a?"right":45<a&&135>a?"down":"up"}var s=0,t=0,u=0,v=0,e=q(g);if(d&&"string"==typeof d)if("next"==d)r(e),n(e,0);else if("prev"==d)r(e),n(e,1);else{if(-1!=d.indexOf("goto")){r(e);var k=d.slice(5);y(e,k)}}else{var k=e.find(".frame"),
l=e.parent(),p=0;if("backward"==d.mode||"backward-circular"==d.mode)p=1;var f={count:k.length,currentFrame:0,direction:p,duration:d.duration,easing:d.easing,fullwidth:d.fullwidth,killtimer:d.killtimer,mode:d.mode,pagination:d.pagination,pagination_img_default:d.pagination_img_default,pagination_img_active:d.pagination_img_active,width:l.outerWidth(),original_width:l.outerWidth(),total_width:l.outerWidth()*k.length};e.css("width",f.total_width+"px");e.data("carousel",f);if(d.pagination){$pagination=
$('<div class="pagination" />');for(l=0;l<k.length;l++)p=$("<a />").attr("id",String(l+1)).css("cursor","pointer"),$("<img />").attr({id:"page_"+String(l+1),src:d.pagination_img_default}).appendTo(p),p.click(function(){y(e,$(this).attr("id"))}),p.appendTo($pagination);$pagination.appendTo(e.parent());m(e,0,0)}0!=d.start&&(f.currentFrame=d.start,f.pagination&&m(e,0,f.currentFrame),h(e,f.width*f.currentFrame,0,""));"forward-backward"==d.mode&&(0==d.start&&$("#"+e.attr("id")+"_back").css("display","none"),
d.start>=k.length-1&&$("#"+e.attr("id")+"_next").css("display","none"));0!=d.delay&&(k=setInterval(function(){n(e,e.data("carousel").direction)},d.delay),e.data("timerId",k));"Microsoft Internet Explorer"!=navigator.appName&&(g.addEventListener("touchstart",C,!1),g.addEventListener("touchmove",D,!1),g.addEventListener("touchend",E,!1),g.addEventListener("touchcancel",B,!1));d.fullwidth&&(z(g),$(window).resize(function(){z(g)}))}}})(jQuery);